import{a as G}from"/build/_shared/chunk-V7A4TTYH.js";import"/build/_shared/chunk-BRSLZYGM.js";import{a as v}from"/build/_shared/chunk-TE53RJ7G.js";import"/build/_shared/chunk-EKVI7LUR.js";import{a as M}from"/build/_shared/chunk-6KU7KB65.js";import{a as g}from"/build/_shared/chunk-TLKRROZH.js";import{a as F,b as H,c as I,d as A,e as E,f as B,g as O,k as q}from"/build/_shared/chunk-PLAFFANM.js";import{b as f}from"/build/_shared/chunk-6NL3JN34.js";import"/build/_shared/chunk-YE2UENJQ.js";import{a as R}from"/build/_shared/chunk-KTYYHXXO.js";import{a as V,e as S,f as T}from"/build/_shared/chunk-57Q5BGZR.js";import"/build/_shared/chunk-HB276KJY.js";import{a as k,c as D,j as _,n}from"/build/_shared/chunk-JP2RFOQ7.js";import{d as s}from"/build/_shared/chunk-G5WX4PPA.js";var Z=s(V(),1);var o=s(k(),1);var U=s(k(),1);var b=s(n(),1),w=U.forwardRef(({className:i,value:y=0,...c},r)=>{let l=Math.min(Math.max(y,0),100);return(0,b.jsx)("div",{ref:r,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l,className:S("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",i),...c,children:(0,b.jsx)("div",{className:"h-full w-full flex-1 bg-primary transition-all duration-300 ease-in-out",style:{transform:`translateX(-${100-l}%)`}})})});w.displayName="Progress";var e=s(n(),1);function W({userId:i}){let y=D(),{toast:c}=R(),[r,l]=(0,o.useState)(1),[m,C]=(0,o.useState)(!1),[x,a]=(0,o.useState)(null),[u,X]=(0,o.useState)(new Date),[h,Y]=(0,o.useState)("28"),[P,$]=(0,o.useState)(!0),[L,z]=(0,o.useState)(!1),J=()=>{if(r===1&&!u){a("Please select your last period date");return}if(r===2){let t=parseInt(h);if(isNaN(t)||t<21||t>35){a("Cycle length must be between 21 and 35 days");return}}r<3&&(a(null),l(r+1))},K=()=>{a(null),l(r-1)},Q=async()=>{if(!u){a("Please select your last period date");return}let t=parseInt(h);if(isNaN(t)||t<21||t>35){a("Cycle length must be between 21 and 35 days");return}try{C(!0),a(null);let p={user_id:i,cycle_length:t,last_period_date:u.toISOString().split("T")[0],has_period_reminders:P,has_pill_reminders:L},{error:d}=await T.from("user_preferences").insert(p);if(d)throw d;c({title:"Setup complete",description:"Your preferences have been saved successfully."}),y("/dashboard")}catch(p){let d=p instanceof Error?p.message:"Failed to save preferences";a(d),c({variant:"destructive",title:"Error",description:d})}finally{C(!1)}};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:(0,e.jsxs)("div",{className:"w-full max-w-lg",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"Welcome to Period Tracker"}),(0,e.jsx)("p",{className:"text-muted-foreground mt-2",children:"Let's get your account set up"})]}),(0,e.jsx)(w,{value:r/3*100,className:"mb-8"}),(0,e.jsxs)(F,{children:[(0,e.jsxs)(H,{children:[(0,e.jsxs)(I,{children:[r===1&&"When was your last period?",r===2&&"How long is your cycle?",r===3&&"Set up reminders"]}),(0,e.jsxs)(A,{children:[r===1&&"This helps us predict your next period",r===2&&"Most cycles are between 21 and 35 days",r===3&&"Choose what you want to be reminded about"]})]}),(0,e.jsxs)(E,{className:"space-y-6",children:[r===1&&(0,e.jsx)(G,{mode:"single",selected:u,onSelect:X,disabled:t=>t>new Date,className:"rounded-md border"}),r===2&&(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(g,{htmlFor:"cycleLength",children:"Cycle Length (days)"}),(0,e.jsx)(M,{id:"cycleLength",type:"number",min:21,max:35,value:h,onChange:t=>Y(t.target.value),className:"w-32"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Most cycles are between 21 and 35 days"})]}),r===3&&(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"space-y-0.5",children:[(0,e.jsx)(g,{children:"Period Reminders"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get notified about your upcoming periods"})]}),(0,e.jsx)(v,{checked:P,onCheckedChange:$})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"space-y-0.5",children:[(0,e.jsx)(g,{children:"Pill Reminders"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get reminded to take your pills"})]}),(0,e.jsx)(v,{checked:L,onCheckedChange:z})]})]}),x&&(0,e.jsx)(B,{variant:"destructive",children:(0,e.jsx)(O,{children:x})}),(0,e.jsxs)("div",{className:"flex justify-between pt-4",children:[r>1?(0,e.jsx)(f,{variant:"outline",onClick:K,disabled:m,children:"Back"}):(0,e.jsx)("div",{}),r<3?(0,e.jsx)(f,{onClick:J,disabled:m,children:"Next"}):(0,e.jsxs)(f,{onClick:Q,disabled:m,children:[m&&(0,e.jsx)(q,{className:"mr-2 h-4 w-4 animate-spin"}),"Complete Setup"]})]})]})]})]})})}var N=s(n(),1);function j(){let{userId:i}=_();return(0,N.jsx)("main",{children:(0,N.jsx)(W,{userId:i})})}export{j as default};
